import{r as v,c as Q,G as a,J as I,L as $,B as o,D as e,H as g,P as k,S as j,U as Y,O as H,j as Z,A as K,I as i,F as U,K as x,M as E,N as F,V as ee,W as te,X as ae,u as se}from"./@vue-hr5trhWq.js";import{d as G,t as C,x as V,y as M,z as T,h as A,A as q,B as oe,C as ie,D as R,i as ne,o as re}from"./@ionic-DMGIWTh5.js";import{g as le,a as ce,b as me,c as B,u as W,d as ue,s as ge,e as de,f as fe,h as P,i as pe,j as ye}from"./index-B-AJNu5a.js";import{_ as he}from"./Marquee-DOTFBfK_.js";import{_ as ve}from"./UserInfo-DU6JvHmQ.js";import{b as Le}from"./vue-router-Z22CwvRX.js";import{d as _e}from"./pinia-s_8tzVDy.js";import{_ as Ge,u as we}from"./useMailStore-BjZc79Yh.js";import{S as Se,A as Ie,P as be,a as ke}from"./swiper-D983U4CL.js";import"./@stencil-DBaMOtEh.js";import"./@capacitor-BXp5o1ZG.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./vue-i18n-BwdP5-YB.js";import"./@intlify-BAcCFw_v.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";const J=_e("game",()=>{const p=v([]),L=async()=>{const n=await le();n.state==="200"&&(p.value=n.resultData||[])},l=v([]),d=async()=>{const n=await ce();n.state==="200"&&(l.value=n.resultData||[])},f=v([]),_=v([]),m=v([]),y=v([]);return{favoriteGameList:p,getFavoriteGames:L,recentGameList:l,getRecentGames:d,recentSearches:f,popularSearches:_,hotGameList:m,recommendGameList:y,getGameSearchData:async()=>{const n=await me();return n.state,code===200&&n&&(f.value=n.resultData.recentSearches||[],_.value=n.resultData.popularSearches||[],l.value=n.resultData.recentGameList||[],m.value=n.resultData.hotGameList||[],y.value=n.resultData.recommendGameList||[]),!0}}},{persistedState:{persist:!1}}),$e={key:0,class:"game-name"},X={__name:"GameItem",props:{game:{type:Object,require:!0}},setup(p){const{getPublicUrl:L}=W(),l=p,d=Le(),f=B(),_=J(),m=async()=>{if(l.game.iconType!=2){f.fullLoading=!0;const n=l.game.gameId||l.game.id,h=await ue({gameId:n});if(h.state==="200"){const S=Capacitor.convertFileSrc(h.resultData);await _.getRecentGames(),d.push({name:"GameWeb",query:{gameId:n,url:encodeURIComponent(S)}})}else await(await C.create({message:h.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present();f.fullLoading=!1}},y=Q(()=>_.favoriteGameList.filter(h=>h.gameId==l.game.gameId||h.gameId==l.game.id).length>0),w=async()=>{if(l.game.iconType!=2){f.fullLoading=!0;const n=l.game.gameId||l.game.id,h=await ge({gameId:n,opt:y.value?2:1});h.state==="200"?_.getFavoriteGames():await(await C.create({message:h.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),f.fullLoading=!1}};return(n,h)=>(a(),I("div",{class:"game-item",onClick:j(m,["stop"])},[$("div",{class:Y(["game-image",{large:p.game.imageSize==2}])},[o(e(G),{class:"game-icon",src:p.game.imageUrl},null,8,["src"]),p.game.cornerMark==1?(a(),g(e(G),{key:0,class:"game-tag",src:e(L)("/home/icon-new.png")},null,8,["src"])):k("",!0),p.game.cornerMark==2?(a(),g(e(G),{key:1,class:"game-tag",src:e(L)("/home/icon-best.png")},null,8,["src"])):k("",!0),p.game.iconType!=2?(a(),I("div",{key:2,class:"game-collect",onClick:j(w,["stop"])},[y.value?(a(),g(e(G),{key:0,src:e(L)("/home/icon-collection-select.png"),style:{width:"24px",height:"24px"}},null,8,["src"])):(a(),g(e(G),{key:1,src:e(L)("/home/icon-collection-normal.png"),style:{width:"24px",height:"24px"}},null,8,["src"]))])):k("",!0)],2),p.game.imageSize!=2?(a(),I("div",$e,H(p.game.name),1)):k("",!0)]))}},He=["onClick"],Te={__name:"GameList",emits:["reduceHeaderHeight"],setup(p,{emit:L}){const l=B(),{preLoadImg:d}=P(),f=v(null),_=v(null),m=Z({}),y=v(1),w=v([]);let n=!1;const h=L;K(async()=>await S());const S=async()=>{const u=await de();if(u.state==="200"){w.value=u.resultData.labelList||[],y.value=Number(w.value[0].labelId);const s=u.resultData.firstLabelGameList,r=u.resultData.categoryList;w.value[0].gameList=u.resultData.gameAndCategoryList.map(t=>{if(t.iconType==1){const c=s.filter(b=>b.status&&b.gameId==t.id);t.name=c.length>0?c[0].gameName:""}if(t.iconType==2){const c=r.filter(b=>b.categoryId==t.id);t.name=c.length>0?c[0].categoryName:""}return t});for(const[t,c]of w.value[0].gameList.entries())t<=12&&await d(c.imageUrl);l.startLoading=!1;for(const[t,c]of w.value.entries())d(c.imageUrlSelected),d(c.imageUrlUnselected),t>0&&(c.gameList=await D(c.labelId),c.gameList.forEach(b=>d(b.imageUrl)))}else await(await C.create({message:u.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present()},D=async u=>{const s=await fe({labelId:u});if(s.state==="200"){const r=s.resultData.gameList.filter(t=>t.status)||[];return s.resultData.gameAndCategoryList.map(t=>{const c=r.filter(b=>b.status&&b.gameId==t.id);return t.name=c.length>0?c[0].gameName:"",t}).filter(t=>t.imageUrl)}else return await(await C.create({message:s.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),[]},N=u=>{n=!0,y.value=Number(u),m[u].$el.scrollIntoView({behavior:"smooth"})},z=u=>{const s=f.value.$el.offsetHeight,r=_.value.$el.offsetHeight;if(s<r&&u.target.scrollTop>0&&h("reduceHeaderHeight",s-r),u.target.scrollTop==0&&h("reduceHeaderHeight",0),n){const t=m[y.value].$el.offsetTop,c=t+m[y.value].$el.offsetHeight;t<=u.target.scrollTop&&u.target.scrollTop<=c&&(n=!1)}else for(const t in m)m[t].$el.offsetTop<=u.target.scrollTop&&(y.value=Number(t))};return(u,s)=>(a(),g(e(A),{ref_key:"gameList",ref:f,class:"game-list"},{default:i(()=>[o(e(V),null,{default:i(()=>[o(e(M),{class:"ion-justify-content-start"},{default:i(()=>[o(e(T),{class:"game-menu",ref_key:"gameMenu",ref:_,size:"2.2"},{default:i(()=>[(a(!0),I(U,null,x(w.value,r=>(a(),I("div",{key:r.labelId,class:"game-label",onClick:t=>N(r.labelId)},[o(E,{name:"fade"},{default:i(()=>[y.value==Number(r.labelId)?(a(),g(e(G),{key:0,src:r.imageUrlSelected,class:"game-img"},null,8,["src"])):(a(),g(e(G),{key:1,src:r.imageUrlUnselected,class:"game-img"},null,8,["src"]))]),_:2},1024)],8,He))),128))]),_:1},512),o(e(T),{size:"9.8",class:"games",onScroll:z},{default:i(()=>[(a(!0),I(U,null,x(w.value,r=>(a(),g(e(M),{ref_for:!0,ref:t=>m[r.labelId]=t,key:r.labelId,class:"ion-justify-content-start"},{default:i(()=>[(a(!0),I(U,null,x(r.gameList,t=>(a(),g(e(T),{size:t.imageSize==2?12:t.imageSize==3?8:4},{default:i(()=>[o(X,{game:t},null,8,["game"])]),_:2},1032,["size"]))),256))]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1},512))}},O={__name:"GameSub",props:{gameKey:{type:String,require:!0}},setup(p){const L=p,l=B(),d=J(),{preLoadImg:f}=P();return K(async()=>{l.fullLoading=!0,L.gameKey=="recentGameList"&&await d.getRecentGames(),L.gameKey=="favoriteGameList"&&await d.getFavoriteGames();for(const[_,m]of d[L.gameKey].entries())_<=16?await f(m.imageUrl):f(m.imageUrl);l.fullLoading=!1}),(_,m)=>(a(),g(e(A),{class:"game-sub"},{default:i(()=>[e(l).fullLoading||e(d)[p.gameKey].length==0?(a(),g(Ge,{key:0,class:"no-data"})):(a(),g(e(V),{key:1},{default:i(()=>[o(e(M),{class:"ion-justify-content-start"},{default:i(()=>[(a(!0),I(U,null,x(e(d)[p.gameKey],y=>(a(),g(e(T),{size:"3"},{default:i(()=>[o(X,{game:y},null,8,["game"])]),_:2},1024))),256))]),_:1})]),_:1}))]),_:1}))}},De={key:0,class:"activity-icon"},Ue={class:"activity-icon"},xe={class:"item-button"},Ce={class:"item-button"},Ze={__name:"Home",setup(p){const L=B(),l=we(),d=pe(),{getPublicUrl:f}=W(),{preLoadImg:_}=P(),m=v("GameList"),y={GameList:Te,GameRecent:O,GameFavorite:O},w={GameList:null,GameRecent:"recentGameList",GameFavorite:"favoriteGameList"},n=v(null),h=v(null),S=v(0),D=v([]),N=async()=>{const s=await ye();s.state==="200"?D.value=s.resultData.bannerList||[]:await(await C.create({message:s.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present()};K(async()=>{await N();for(const[s,r]of D.value.entries())s<=1&&await _(r.imageUrl);await l.getMailList()});const z=v(!1),u=s=>{z.value=s<0,s<0&&(S.value=n.value.$el.offsetHeight+s,se(()=>h.value.$el.scrollIntoView({behavior:"smooth"}))),s==0&&(S.value=s)};return(s,r)=>(a(),g(e(A),{class:"home"},{default:i(()=>[o(e(ne),{ref_key:"homeHeader",ref:n,style:ee("height: ".concat(S.value==0?"fit-content":S.value+"px"))},{default:i(()=>[o(e(V),{style:{padding:"0",position:"sticky",top:"0","z-index":"2"}},{default:i(()=>[o(e(M),{class:"ion-justify-content-between"},{default:i(()=>[o(e(T),{size:"4"},{default:i(()=>[o(e(G),{src:e(L).imgLogo.headerLogo,style:{width:"100%",margin:"auto"}},null,8,["src"])]),_:1}),o(e(T),{size:"auto",style:{display:"flex"}},{default:i(()=>[e(d).isShowTurnplate?(a(),I("div",De,[o(e(G),{src:e(f)("/home/icon-home-game.png")},null,8,["src"]),e(d).turnplate.totalRemainTimes>0?(a(),g(e(q),{key:0,class:"activity-icon-tag"},{default:i(()=>[F(H(e(d).turnplate.totalRemainTimes||10),1)]),_:1})):k("",!0)])):k("",!0),$("div",Ue,[o(e(G),{src:e(f)("/home/icon-mail.png"),"router-link":"/account/mail"},null,8,["src"]),e(l).hasUnread?(a(),g(e(q),{key:0,class:"activity-icon-tag"})):k("",!0)])]),_:1})]),_:1})]),_:1}),o(E,{name:"fade"},{default:i(()=>[$("div",null,[z.value?k("",!0):(a(),g(e(Se),{key:0,modules:[e(Ie),e(be),e(oe)],centeredSlides:!0,pagination:{clickable:!0},autoplay:{delay:3e3},loop:!0,lazyPreloadPrevNext:1},{default:i(()=>[(a(!0),I(U,null,x(D.value,(t,c)=>(a(),g(e(ke),{key:"banner_".concat(c)},{default:i(()=>[o(e(G),{src:t.imageUrl,loading:"lazy"},null,8,["src"])]),_:2},1024))),128))]),_:1},8,["modules"])),o(he),o(ve,{class:"user-info",ref_key:"userInfo",ref:h},{default:i(()=>[$("div",xe,[o(e(G),{src:e(f)("/home/icon-deposit.png"),style:{height:"8vw",margin:"auto"}},null,8,["src"]),$("div",null,H(s.$t("home.deposit")),1)]),$("div",Ce,[o(e(G),{src:e(f)("/home/icon-withdraw.png"),style:{height:"8vw",margin:"auto"}},null,8,["src"]),$("div",null,H(s.$t("home.withdraw")),1)])]),_:1},512),o(e(ie),{modelValue:m.value,"onUpdate:modelValue":r[0]||(r[0]=t=>m.value=t),mode:"md"},{default:i(()=>[o(e(R),{class:"ion-text-capitalize",value:"GameList"},{default:i(()=>[F(H(s.$t("home.allgames")),1)]),_:1}),o(e(R),{class:"ion-text-capitalize",value:"GameRecent"},{default:i(()=>[F(H(s.$t("home.recent")),1)]),_:1}),o(e(R),{class:"ion-text-capitalize",value:"GameFavorite"},{default:i(()=>[F(H(s.$t("home.favorite")),1)]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1},8,["style"]),o(e(re),null,{default:i(()=>[(a(),g(te,{exclude:"GameSub"},[(a(),g(ae(y[m.value]),{class:"bottom-view",gameKey:w[m.value],onReduceHeaderHeight:u},null,40,["gameKey"]))],1024))]),_:1})]),_:1}))}};export{Ze as default};
