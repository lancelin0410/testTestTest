import{r as w,H as i,I as r,J as u,M as n,C as h,E as t,P as c,K as I,Q as S,U as y,O as k,B as D,L as N,F as O}from"./@vue-Byjcq-FP.js";import{d as _,K as b,O as E,t as f,L as T,h as V,M as F,E as R}from"./@ionic-qvL_eljm.js";import{c as $,u as C,l as U}from"./index-P6cHJn6P.js";import{u as x,r as J,a as K,d as H,_ as Q}from"./useMailStore-BwZAu6dS.js";import{u as j}from"./vue-i18n-CK_WgmAH.js";import"./@stencil-DBaMOtEh.js";import"./@capacitor-BXp5o1ZG.js";import"./vue-router-CLGTjHYu.js";import"./ionicons-T4lv_k6t.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./pinia-DpQ9eBLY.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";import"./@intlify-BAcCFw_v.js";const q={class:"wrapper"},G={class:"mail-title"},W={class:"mail-sub-title"},X={style:{"font-size":"0.9rem"}},Y={style:{"font-size":"0.7rem",color:"#FD5959"}},Z={class:"mail-content"},tt={key:0,class:"mail-attaches"},at={__name:"MailPopup",setup(A,{expose:m}){const{t:d}=j(),o=$(),p=x(),{getImgUrl:v}=C(),{popupEnter:g,popupLeave:M}=U(),a=w(!1),s=w({}),B=async e=>{if(o.barLoading=!0,e.isRead==0){const l=await J({mailId:e.id});l.state==="200"?e.isRead=1:await(await f.create({message:l.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present()}s.value=e,o.barLoading=!1,a.value=!0},z=async()=>{o.barLoading=!0;const e=await K({mailId:s.value.id});e.state==="200"?(await p.getMailList(),o.barLoading=!1,a.value=!1,s.value.attachesStatus=1,await(await f.create({message:d("mail.message.receiveSuccess"),duration:1500,position:"top",color:"success",translucent:!0})).present()):(o.barLoading=!1,await(await f.create({message:e.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present())},P=async()=>{o.barLoading=!0;const e=await H({mailId:s.value.id});e.state==="200"?(await p.getMailList(),o.barLoading=!1,a.value=!1,await(await f.create({message:d("mail.message.deleteSuccess"),duration:1500,position:"top",color:"success",translucent:!0})).present()):(await(await f.create({message:e.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),o.barLoading=!1)};return m({showMail:B}),(e,l)=>(i(),r(t(E),{class:"mail-popup",isOpen:a.value,enterAnimation:t(g),leaveAnimation:t(M),onDidDismiss:l[1]||(l[1]=L=>a.value=!1)},{default:u(()=>[n("div",q,[h(t(_),{class:"btn-close",src:t(v)("/mail/icon-popup-close.png"),onClick:l[0]||(l[0]=L=>a.value=!1)},null,8,["src"]),n("h3",G,c(s.value.title||""),1),n("div",W,[n("div",X,c(e.$t("mail.dearPlayer"))+":",1),n("div",Y,c(s.value.createTime||""),1)]),n("div",Z,c(s.value.content||""),1),s.value.attaches&&s.value.attachesStatus===0?(i(),I("div",tt,[h(t(_),{src:t(v)("/mail/icon-coin.png"),style:{width:"35px",height:"35px"}},null,8,["src"]),n("div",null,c(Math.round(JSON.parse(s.value.attaches).amount*100)/100),1)])):S("",!0),s.value.attaches&&s.value.attachesStatus===0?(i(),r(t(b),{key:1,class:"btn-confirm ion-text-capitalize",fill:"solid",shape:"round",onClick:y(z,["stop"])},{default:u(()=>[k(c(e.$t("mail.button.confirm")),1)]),_:1})):(i(),r(t(b),{key:2,class:"btn-del ion-text-capitalize",fill:"solid",shape:"round",onClick:y(P,["stop"])},{default:u(()=>[k(c(e.$t("mail.button.delete")),1)]),_:1}))])]),_:1},8,["isOpen","enterAnimation","leaveAnimation"]))}},et={slot:"start",class:"mail-icon"},st={class:"mail-title"},ot={style:{"font-size":"1rem"}},it={style:{"font-size":"0.7rem"}},nt={class:"mail-detail"},bt={__name:"Mail",setup(A){const m=$(),d=x(),{getImgUrl:o}=C(),p=w(null);D(async()=>{m.barLoading=!0,await d.getMailList(),m.barLoading=!1});const v=g=>{p.value.showMail(g)};return(g,M)=>(i(),r(t(V),{class:"mail"},{default:u(()=>[t(m).barLoading||!t(d).hasMail?(i(),r(Q,{key:0,class:"no-data",desc:g.$t("mail.message.nodata")},null,8,["desc"])):(i(),r(t(T),{key:1},{default:u(()=>[(i(!0),I(O,null,N(t(d).mailList,a=>(i(),r(t(F),{key:a.id,class:"mail-item",lines:"none",onClick:y(s=>v(a),["stop"])},{default:u(()=>[n("div",et,[a.isRead?(i(),r(t(_),{key:0,class:"mail-img",src:t(o)("/mail/icon-mail-open.png")},null,8,["src"])):(i(),r(t(_),{key:1,class:"mail-img",src:t(o)("/mail/icon-mail.png")},null,8,["src"])),a.attaches&&a.attachesStatus===0?(i(),r(t(_),{key:2,class:"mail-tag",src:t(o)("/mail/icon-mail-gift.png")},null,8,["src"])):S("",!0)]),h(t(R),{class:"mail-content"},{default:u(()=>[n("div",st,[n("div",ot,c(a.title||""),1),n("div",it,c(a.createTime||""),1)]),n("div",nt,c(a.content||""),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})),h(at,{ref_key:"mailPopup",ref:p},null,512)]),_:1}))}};export{bt as default};
