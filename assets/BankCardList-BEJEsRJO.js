import{r as h,j as F,B as P,H as u,I as C,J as c,C as e,E as t,K as m,L as B,F as U,V as I,M as d,P as r,R as g,O as N,W as $}from"./@vue-KvDcA5L4.js";import{u as W}from"./vue-i18n-CPl1SEIs.js";import{t as y,L as J,K as _,P as V,O as j,i as E,j as H,k as K,m as q,q as S,U as z,R as v,d as b,h as G,M as Q,V as X}from"./@ionic-CQtneEHh.js";import{b as Y,a as Z,f as tt,g as at,h as et}from"./ionicons-T4lv_k6t.js";import{c as ot,e as nt,m as lt,u as ct,n as st}from"./index-DbfdoCpI.js";import"./@intlify-BAcCFw_v.js";import"./@stencil-DBaMOtEh.js";import"./@capacitor-BXp5o1ZG.js";import"./vue-router-D1p6pxpQ.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./pinia-7EZHWT0u.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";const ut={style:{color:"#fdea5a"}},rt={style:{margin:"4px 0"}},it={class:"block-title"},dt={key:0,style:{margin:"4px 0"}},pt={class:"block-title"},mt={key:1,style:{margin:"4px 0"}},ft={class:"block-title"},wt={key:2,style:{margin:"4px 0"}},ht=d("div",{class:"block-title"},"CNIC",-1),Ct=d("span",{class:"input-prefix",slot:"start"},"CNIC",-1),It={key:3,style:{margin:"4px 0"}},gt={class:"block-title"},Mt={__name:"BankCardList",setup(vt){const{t:R}=W(),i=ot(),L=nt(),{getImgUrl:k}=ct(),f=h([]),A=h(!0),w=h(!1),s=h({}),l=F({accountName:null,accountNumber:null,CNIC:null,accountIfsc:null});P(async()=>{var n;i.barLoading=!0;const o=await lt({userId:L.userInfo.id});o.state==="200"?(f.value=((n=o.resultData.withdrawAccounts)==null?void 0:n.map(a=>{a.withdrawAccount=JSON.parse(a.withdrawAccount);const p=i.appConfig.withdrawTypes.filter(T=>a.withdrawTypeId==T.id);return p.length>0&&(a.iconUrl=p[0].iconUrl),a}))||[],A.value=!(i.appConfig.withdrawTypes.length==f.value.length&&f.value.length!=0),s.value=f.value[0]):await(await y.create({message:o.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),i.barLoading=!1});const x=()=>{s.value=i.appConfig.withdrawTypes[0],l.accountName=null,l.accountNumber=null,l.CNIC=null,l.accountIfsc=null,w.value=!0},O=o=>{w.value=!0},M=async()=>{if(console.log(s.value.withdrawAccountRule,l),s.value.withdrawAccountRule.includes("accountName")&&!l.accountName||s.value.withdrawAccountRule.includes("accountNumber")&&!l.accountNumber||s.value.withdrawAccountRule.includes("CNIC")&&!l.CNIC||s.value.withdrawAccountRule.includes("accountIfsc")&&!l.accountIfsc)return;if(l.accountIfsc.split("")[4]!="0"){await(await y.create({message:R("account.bankCard.tips.ifscTips"),duration:1500,position:"top",color:"warning",translucent:!0})).present();return}i.fullLoading=!0,(await st({withdrawAccount:JSON.stringify(l),withdrawTypeId:s.value.id})).state=="200"&&(await(await y.create({message:"Success",duration:1500,position:"top",translucent:!0,icon:checkmarkOutline,color:"success"})).present(),w.value=!1),i.fullLoading=!1},D=(o,n)=>o&&n?o.id===n.id:o===n;return(o,n)=>(u(),C(t(G),{class:"bank-card-list"},{default:c(()=>[e(t(S),null,{default:c(()=>[e(t(J),null,{default:c(()=>[(u(!0),m(U,null,B(f.value,(a,p)=>(u(),C(t(Q),{key:p,class:$(["account-item",{select:!0}]),lines:"none"},{default:c(()=>[e(t(b),{slot:"start",src:a.iconUrl},null,8,["src"]),d("span",null,r(o.$t("account.bankCard.text.accNo"))+" "+r(a.withdrawAccount.accountNumber),1),e(t(V),{slot:"end",icon:t(et),onClick:I(T=>O(a.id),["stop"])},null,8,["icon","onClick"])]),_:2},1024))),128))]),_:1}),(A.value,u(),C(t(_),{key:0,fill:"clear",expand:"block",onClick:I(x,["stop"])},{default:c(()=>[e(t(V),{slot:"start",icon:t(Y),style:{color:"#fdea5a"}},null,8,["icon"]),d("span",ut,r(o.$t("account.bankCard.text.addBankCardText")),1)]),_:1})),e(t(j),{class:"account-info","is-open":w.value},{default:c(()=>[e(t(E),null,{default:c(()=>[e(t(H),null,{default:c(()=>[e(t(K),{slot:"start"},{default:c(()=>[e(t(_),{onClick:n[0]||(n[0]=I(a=>w.value=!1,["stop"]))},{default:c(()=>[e(t(V),{slot:"icon-only",icon:t(Z),color:"light"},null,8,["icon"])]),_:1})]),_:1}),e(t(q),null,{default:c(()=>[N(r(o.$t("account.header.withdrawalBankTitle")),1)]),_:1})]),_:1})]),_:1}),e(t(S),{class:"ion-padding"},{default:c(()=>[d("div",rt,[d("div",it,r(o.$t("account.bankCard.labels.accountType")),1),e(t(z),{modelValue:s.value,"onUpdate:modelValue":n[1]||(n[1]=a=>s.value=a),class:$(["account-type-select",{hide:t(i).appConfig.withdrawTypes.length<2}]),mode:"md",interface:"popover",fill:"outline",color:"danger","toggle-icon":t(tt),"expanded-icon":t(at),compareWith:D},{default:c(()=>[(u(!0),m(U,null,B(t(i).appConfig.withdrawTypes,(a,p)=>(u(),C(t(X),{key:p,value:a},{default:c(()=>[N(r(a.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","class","toggle-icon","expanded-icon"])]),s.value.withdrawAccountRule.includes("accountName")?(u(),m("div",dt,[d("div",pt,r(o.$t("account.bankCard.labels.accountName")),1),e(t(v),{modelValue:l.accountName,"onUpdate:modelValue":n[2]||(n[2]=a=>l.accountName=a),placeholder:o.$t("account.bankCard.placeholder.accountName")},{default:c(()=>[e(t(b),{class:"input-prefix",slot:"start",src:t(k)("/account/icon/user.png")},null,8,["src"])]),_:1},8,["modelValue","placeholder"])])):g("",!0),s.value.withdrawAccountRule.includes("accountNumber")?(u(),m("div",mt,[d("div",ft,r(o.$t("account.bankCard.labels.accountNumber")),1),e(t(v),{modelValue:l.accountNumber,"onUpdate:modelValue":n[3]||(n[3]=a=>l.accountNumber=a),placeholder:o.$t("account.bankCard.placeholder.accountNumber")},{default:c(()=>[e(t(b),{class:"input-prefix",slot:"start",src:t(k)("/account/icon/password.png")},null,8,["src"])]),_:1},8,["modelValue","placeholder"])])):g("",!0),s.value.withdrawAccountRule.includes("CNIC")?(u(),m("div",wt,[ht,e(t(v),{modelValue:l.CNIC,"onUpdate:modelValue":n[4]||(n[4]=a=>l.CNIC=a),placeholder:"CNIC"},{default:c(()=>[Ct]),_:1},8,["modelValue"])])):g("",!0),s.value.withdrawAccountRule.includes("accountIfsc")?(u(),m("div",It,[d("div",gt,r(o.$t("account.bankCard.labels.accountIfsc")),1),e(t(v),{modelValue:l.accountIfsc,"onUpdate:modelValue":n[5]||(n[5]=a=>l.accountIfsc=a),placeholder:o.$t("account.bankCard.placeholder.accountIfsc")},{default:c(()=>[e(t(b),{class:"input-prefix",slot:"start",src:t(k)("/account/icon/IFSC.png")},null,8,["src"])]),_:1},8,["modelValue","placeholder"])])):g("",!0),e(t(_),{class:"btn-confirm",expand:"block",shape:"round",onClick:I(M,["stop"])},{default:c(()=>[N(r(o.$t("account.button.confirmCapital")),1)]),_:1})]),_:1})]),_:1},8,["is-open"])]),_:1})]),_:1}))}};export{Mt as default};
