import{r as w,G as o,H as c,I as d,L as i,B as h,D as t,O as u,J as L,P as S,S as y,N as b,A as z,K as D,F as N}from"./@vue-CTzZmrEY.js";import{d as _,K as k,O as P,t as f,L as O,h as T,M as V,E as A}from"./@ionic-DW2CtbHZ.js";import{u as I}from"./index-BA_uPNhW.js";import{u as C,r as F,a as R,d as E,_ as J}from"./useMailStore-I-37QJSi.js";import{u as K}from"./vue-i18n-DnF4oqIJ.js";import"./@stencil-DBaMOtEh.js";import"./@capacitor-UngXGu7w.js";import"./vue-router-D889LiZM.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./pinia-DKQUv1OW.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";import"./@intlify-BAcCFw_v.js";const U={class:"wrapper"},G={class:"mail-title"},H={class:"mail-sub-title"},j={style:{"font-size":"0.9rem"}},q={style:{"font-size":"0.7rem",color:"#FD5959"}},Q={class:"mail-content"},W={key:0,class:"mail-attaches"},X={__name:"MailPopup",setup(x,{expose:g}){const{t:m}=K(),s=I(),p=C(),v="/",n=w(!1),e=w({}),r=async a=>{if(s.barLoading=!0,a.isRead==0){const l=await F({mailId:a.id});l.state==="200"?a.isRead=1:await(await f.create({message:l.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present()}e.value=a,s.barLoading=!1,n.value=!0},M=async()=>{s.barLoading=!0;const a=await R({mailId:e.value.id});a.state==="200"?(await p.getMailList(),s.barLoading=!1,n.value=!1,e.value.attachesStatus=1,await(await f.create({message:m("mail.message.receiveSuccess"),duration:1500,position:"top",color:"success",translucent:!0})).present()):(s.barLoading=!1,await(await f.create({message:a.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present())},B=async()=>{s.barLoading=!0;const a=await E({mailId:e.value.id});a.state==="200"?(await p.getMailList(),s.barLoading=!1,n.value=!1,await(await f.create({message:m("mail.message.deleteSuccess"),duration:1500,position:"top",color:"success",translucent:!0})).present()):(await(await f.create({message:a.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),s.barLoading=!1)};return g({showMail:r}),(a,l)=>(o(),c(t(P),{class:"mail-popup",isOpen:n.value,onDidDismiss:l[1]||(l[1]=$=>n.value=!1)},{default:d(()=>[i("div",U,[h(t(_),{class:"btn-close",src:"".concat(t(v),"mail/icon-popup-close.png"),onClick:l[0]||(l[0]=$=>n.value=!1)},null,8,["src"]),i("h3",G,u(e.value.title||""),1),i("div",H,[i("div",j,u(a.$t("mail.dearPlayer"))+":",1),i("div",q,u(e.value.createTime||""),1)]),i("div",Q,u(e.value.content||""),1),e.value.attaches&&e.value.attachesStatus===0?(o(),L("div",W,[h(t(_),{src:"".concat(t(v),"mail/icon-coin.png"),style:{width:"35px",height:"35px"}},null,8,["src"]),i("div",null,u(Math.round(JSON.parse(e.value.attaches).amount*100)/100),1)])):S("",!0),e.value.attaches&&e.value.attachesStatus===0?(o(),c(t(k),{key:1,class:"btn-confirm ion-text-capitalize",fill:"solid",shape:"round",onClick:y(M,["stop"])},{default:d(()=>[b(u(a.$t("mail.button.confirm")),1)]),_:1})):(o(),c(t(k),{key:2,class:"btn-del ion-text-capitalize",fill:"solid",shape:"round",onClick:y(B,["stop"])},{default:d(()=>[b(u(a.$t("mail.button.delete")),1)]),_:1}))])]),_:1},8,["isOpen"]))}},Y={slot:"start",class:"mail-icon"},Z={class:"mail-title"},tt={style:{"font-size":"1rem"}},at={style:{"font-size":"0.7rem"}},et={class:"mail-detail"},wt={__name:"Mail",setup(x){const g=I(),m=C(),s="/",p=w(null);z(async()=>{g.barLoading=!0,await m.getMailList(),g.barLoading=!1});const v=n=>{p.value.showMail(n)};return(n,e)=>(o(),c(t(T),{class:"mail"},{default:d(()=>[t(m).hasMail?(o(),c(t(O),{key:0},{default:d(()=>[(o(!0),L(N,null,D(t(m).mailList,r=>(o(),c(t(V),{key:r.id,class:"mail-item",lines:"none",onClick:y(M=>v(r),["stop"])},{default:d(()=>[i("div",Y,[r.isRead?(o(),c(t(_),{key:0,class:"mail-img",src:"".concat(t(s),"mail/icon-mail-open.png")},null,8,["src"])):(o(),c(t(_),{key:1,class:"mail-img",src:"".concat(t(s),"mail/icon-mail.png")},null,8,["src"])),r.attaches&&r.attachesStatus===0?(o(),c(t(_),{key:2,class:"mail-tag",src:"".concat(t(s),"mail/icon-mail-gift.png")},null,8,["src"])):S("",!0)]),h(t(A),{class:"mail-content"},{default:d(()=>[i("div",Z,[i("div",tt,u(r.title||""),1),i("div",at,u(r.createTime||""),1)]),i("div",et,u(r.content||""),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):(o(),c(J,{key:1,class:"no-data",desc:n.$t("mail.message.nodata")},null,8,["desc"])),h(X,{ref_key:"mailPopup",ref:p},null,512)]),_:1}))}};export{wt as default};
