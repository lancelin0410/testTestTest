import{r as w,c as Y,G as i,J as k,L as T,B as a,D as e,H as m,P as $,S as q,U as M,O as U,j as Z,A,I as o,F as z,K as x,M as ee,w as te,a as ae,Q as se,N as F,V as oe,W as ie}from"./@vue-CTzZmrEY.js";import{d as G,t as H,x as P,y as B,z as C,h as V,A as O,B as le,C as ne,D as K,i as re,o as ce}from"./@ionic-D6JpvR1m.js";import{g as me,a as ue,b as ge,c as N,u as J,d as de,s as fe,e as pe,f as ye,h as j,i as ve,j as he}from"./index-B1bxWljk.js";import{_ as E}from"./Marquee-BtGNkgqh.js";import{_ as Le}from"./UserInfo-DahwOnLs.js";import{b as _e}from"./vue-router-D889LiZM.js";import{d as we}from"./pinia-DKQUv1OW.js";import{_ as Ge,u as Se}from"./useMailStore-B0kAr6ly.js";import{S as Ie,A as be,P as ke,a as De}from"./swiper-Ba4ICoCD.js";import"./@stencil-DBaMOtEh.js";import"./@capacitor-BXp5o1ZG.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./vue-i18n-DnF4oqIJ.js";import"./@intlify-BAcCFw_v.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";const Q=we("game",()=>{const d=w([]),h=async()=>{const s=await me();s.state==="200"&&(d.value=s.resultData||[])},n=w([]),u=async()=>{const s=await ue();s.state==="200"&&(n.value=s.resultData||[])},g=w([]),L=w([]),r=w([]),p=w([]);return{favoriteGameList:d,getFavoriteGames:h,recentGameList:n,getRecentGames:u,recentSearches:g,popularSearches:L,hotGameList:r,recommendGameList:p,getGameSearchData:async()=>{const s=await ge();return s.state,code===200&&s&&(g.value=s.resultData.recentSearches||[],L.value=s.resultData.popularSearches||[],n.value=s.resultData.recentGameList||[],r.value=s.resultData.hotGameList||[],p.value=s.resultData.recommendGameList||[]),!0}}},{persistedState:{persist:!1}}),Te={key:0,class:"game-name"},X={__name:"GameItem",props:{game:{type:Object,require:!0}},setup(d){const{getPublicUrl:h}=J(),n=d,u=_e(),g=N(),L=Q(),r=async()=>{if(n.game.iconType!=2){g.fullLoading=!0;const s=n.game.gameId||n.game.id,y=await de({gameId:s});if(y.state==="200"){const I=Capacitor.convertFileSrc(y.resultData);await L.getRecentGames(),u.push({name:"GameWeb",query:{gameId:s,url:encodeURIComponent(I)}})}else await(await H.create({message:y.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present();g.fullLoading=!1}},p=Y(()=>L.favoriteGameList.filter(y=>y.gameId==n.game.gameId||y.gameId==n.game.id).length>0),S=async()=>{if(n.game.iconType!=2){g.fullLoading=!0;const s=n.game.gameId||n.game.id,y=await fe({gameId:s,opt:p.value?2:1});y.state==="200"?L.getFavoriteGames():await(await H.create({message:y.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),g.fullLoading=!1}};return(s,y)=>(i(),k("div",{class:"game-item",onClick:q(r,["stop"])},[T("div",{class:M(["game-image",{large:d.game.imageSize==2}])},[a(e(G),{class:"game-icon",src:d.game.imageUrl},null,8,["src"]),d.game.cornerMark==1?(i(),m(e(G),{key:0,class:"game-tag",src:e(h)("/home/icon-new.png")},null,8,["src"])):$("",!0),d.game.cornerMark==2?(i(),m(e(G),{key:1,class:"game-tag",src:e(h)("/home/icon-best.png")},null,8,["src"])):$("",!0),d.game.iconType!=2?(i(),k("div",{key:2,class:"game-collect",onClick:q(S,["stop"])},[p.value?(i(),m(e(G),{key:0,src:e(h)("/home/icon-collection-select.png"),style:{width:"24px",height:"24px"}},null,8,["src"])):(i(),m(e(G),{key:1,src:e(h)("/home/icon-collection-normal.png"),style:{width:"24px",height:"24px"}},null,8,["src"]))])):$("",!0)],2),d.game.imageSize!=2?(i(),k("div",Te,U(d.game.name),1)):$("",!0)]))}},Ue=["onClick"],Ce={__name:"GameList",emits:["reduceHeaderHeight"],setup(d,{emit:h}){const n=N(),{preLoadImg:u}=j(),g=w(null),L=w(null),r=Z({}),p=w(1),S=w([]);let s=!1;const y=h;A(async()=>await I());const I=async()=>{const l=await pe();if(l.state==="200"){S.value=l.resultData.labelList||[],p.value=Number(S.value[0].labelId);const _=l.resultData.firstLabelGameList,f=l.resultData.categoryList;S.value[0].gameList=l.resultData.gameAndCategoryList.map(t=>{if(t.iconType==1){const c=_.filter(b=>b.status&&b.gameId==t.id);t.name=c.length>0?c[0].gameName:""}if(t.iconType==2){const c=f.filter(b=>b.categoryId==t.id);t.name=c.length>0?c[0].categoryName:""}return t});for(const[t,c]of S.value[0].gameList.entries())t<=12&&await u(c.imageUrl);n.startLoading=!1;for(const[t,c]of S.value.entries())u(c.imageUrlSelected),u(c.imageUrlUnselected),t>0&&(c.gameList=await R(c.labelId),c.gameList.forEach(b=>u(b.imageUrl)))}else await(await H.create({message:l.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present()},R=async l=>{const _=await ye({labelId:l});if(_.state==="200"){const f=_.resultData.gameList.filter(t=>t.status)||[];return _.resultData.gameAndCategoryList.map(t=>{const c=f.filter(b=>b.status&&b.gameId==t.id);return t.name=c.length>0?c[0].gameName:"",t}).filter(t=>t.imageUrl)}else return await(await H.create({message:_.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),[]},v=l=>{s=!0,p.value=Number(l),r[l].$el.scrollIntoView({behavior:"smooth"})},D=l=>{const _=g.value.$el.offsetHeight,f=L.value.$el.offsetHeight;if(_<f&&l.target.scrollTop>0&&y("reduceHeaderHeight",_-f),l.target.scrollTop<4&&y("reduceHeaderHeight",0),s){const t=r[p.value].$el.offsetTop,c=t+r[p.value].$el.offsetHeight;t<=l.target.scrollTop&&l.target.scrollTop<=c&&(s=!1)}else for(const t in r)r[t].$el.offsetTop<=l.target.scrollTop&&(p.value=Number(t))};return(l,_)=>(i(),m(e(V),{ref_key:"gameList",ref:g,class:"game-list"},{default:o(()=>[a(e(P),null,{default:o(()=>[a(e(B),{class:"ion-justify-content-start"},{default:o(()=>[a(e(C),{class:"game-menu",ref_key:"gameMenu",ref:L,size:"2.2"},{default:o(()=>[(i(!0),k(z,null,x(S.value,f=>(i(),k("div",{key:f.labelId,class:"game-label",onClick:t=>v(f.labelId)},[a(ee,{name:"fade"},{default:o(()=>[p.value==Number(f.labelId)?(i(),m(e(G),{key:0,src:f.imageUrlSelected,class:"game-img"},null,8,["src"])):(i(),m(e(G),{key:1,src:f.imageUrlUnselected,class:"game-img"},null,8,["src"]))]),_:2},1024)],8,Ue))),128))]),_:1},512),a(e(C),{size:"9.8",class:"games",onScroll:D},{default:o(()=>[(i(!0),k(z,null,x(S.value,f=>(i(),m(e(B),{ref_for:!0,ref:t=>r[f.labelId]=t,key:f.labelId,class:"ion-justify-content-start"},{default:o(()=>[(i(!0),k(z,null,x(f.gameList,t=>(i(),m(e(C),{size:t.imageSize==2?12:t.imageSize==3?8:4},{default:o(()=>[a(X,{game:t},null,8,["game"])]),_:2},1032,["size"]))),256))]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1},512))}},W={__name:"GameSub",props:{gameKey:{type:String,require:!0}},setup(d){const h=d,n=N(),u=Q(),{preLoadImg:g}=j();return A(async()=>{n.fullLoading=!0,h.gameKey=="recentGameList"&&await u.getRecentGames(),h.gameKey=="favoriteGameList"&&await u.getFavoriteGames();for(const[L,r]of u[h.gameKey].entries())L<=16?await g(r.imageUrl):g(r.imageUrl);n.fullLoading=!1}),(L,r)=>(i(),m(e(V),{class:"game-sub"},{default:o(()=>[e(n).fullLoading||e(u)[d.gameKey].length==0?(i(),m(Ge,{key:0,class:"no-data"})):(i(),m(e(P),{key:1},{default:o(()=>[a(e(B),{class:"ion-justify-content-start"},{default:o(()=>[(i(!0),k(z,null,x(e(u)[d.gameKey],p=>(i(),m(e(C),{size:"3"},{default:o(()=>[a(X,{game:p},null,8,["game"])]),_:2},1024))),256))]),_:1})]),_:1}))]),_:1}))}},$e={class:"activity-icon"},ze={class:"activity-icon"},xe={class:"item-button"},He={class:"item-button"},et={__name:"Home",setup(d){const h=N(),n=Se(),u=ve(),{getPublicUrl:g}=J(),{preLoadImg:L}=j(),r=w("GameList"),p={GameList:Ce,GameRecent:W,GameFavorite:W},S={GameList:null,GameRecent:"recentGameList",GameFavorite:"favoriteGameList"},s=w([]),y=async()=>{const v=await he();v.state==="200"?s.value=v.resultData.bannerList||[]:await(await H.create({message:v.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present()};A(async()=>{await y();for(const[v,D]of s.value.entries())v<=1&&await L(D.imageUrl);await n.getMailList()}),te(r,()=>I.value=!1);const I=w(!1),R=v=>{I.value=v<0};return(v,D)=>(i(),m(e(V),{class:"home"},{default:o(()=>[a(e(re),null,{default:o(()=>[a(e(P),{style:{padding:"0",position:"sticky",top:"0","z-index":"2"}},{default:o(()=>[a(e(B),{class:"ion-justify-content-between ion-align-items-center"},{default:o(()=>[a(e(C),{size:I.value?3:4},{default:o(()=>[a(e(G),{src:e(h).imgLogo.headerLogo,style:{width:"100%",margin:"auto"}},null,8,["src"])]),_:1},8,["size"]),a(e(C),{style:{position:"relative"}},{default:o(()=>[a(E,{class:M({simplify:I.value})},null,8,["class"])]),_:1}),a(e(C),{size:"auto",style:{display:"flex"}},{default:o(()=>[ae(T("div",$e,[a(e(G),{src:e(g)("/home/icon-home-game.png")},null,8,["src"]),e(u).turnplate.totalRemainTimes>0?(i(),m(e(O),{key:0,class:"activity-icon-tag"},{default:o(()=>[F(U(e(u).turnplate.totalRemainTimes||10),1)]),_:1})):$("",!0)],512),[[se,e(u).isShowTurnplate]]),T("div",ze,[a(e(G),{src:e(g)("/home/icon-mail.png"),"router-link":"/account/mail"},null,8,["src"]),e(n).hasUnread?(i(),m(e(O),{key:0,class:"activity-icon-tag"})):$("",!0)])]),_:1})]),_:1})]),_:1}),a(e(Ie),{class:M({simplify:I.value}),modules:[e(be),e(ke),e(le)],centeredSlides:!0,pagination:{clickable:!0},autoplay:!1,loop:!0,lazyPreloadPrevNext:1},{default:o(()=>[(i(!0),k(z,null,x(s.value,(l,_)=>(i(),m(e(De),{key:"banner_".concat(_)},{default:o(()=>[a(e(G),{src:l.imageUrl,loading:"lazy"},null,8,["src"])]),_:2},1024))),128))]),_:1},8,["class","modules"]),a(E,{class:M([{simplify:I.value},"main"])},null,8,["class"]),a(Le,{class:"user-info"},{default:o(()=>[T("div",xe,[a(e(G),{src:e(g)("/home/icon-deposit.png"),style:{height:"8vw",margin:"auto"}},null,8,["src"]),T("div",null,U(v.$t("home.deposit")),1)]),T("div",He,[a(e(G),{src:e(g)("/home/icon-withdraw.png"),style:{height:"8vw",margin:"auto"}},null,8,["src"]),T("div",null,U(v.$t("home.withdraw")),1)])]),_:1}),a(e(ne),{modelValue:r.value,"onUpdate:modelValue":D[0]||(D[0]=l=>r.value=l),mode:"md"},{default:o(()=>[a(e(K),{class:"ion-text-capitalize",value:"GameList"},{default:o(()=>[F(U(v.$t("home.allgames")),1)]),_:1}),a(e(K),{class:"ion-text-capitalize",value:"GameRecent"},{default:o(()=>[F(U(v.$t("home.recent")),1)]),_:1}),a(e(K),{class:"ion-text-capitalize",value:"GameFavorite"},{default:o(()=>[F(U(v.$t("home.favorite")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(e(ce),null,{default:o(()=>[(i(),m(oe,{exclude:"GameSub"},[(i(),m(ie(p[r.value]),{class:"bottom-view",gameKey:S[r.value],onReduceHeaderHeight:R},null,40,["gameKey"]))],1024))]),_:1})]),_:1}))}};export{et as default};
