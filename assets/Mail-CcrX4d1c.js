import{r as w,G as i,H as r,I as u,L as n,B as h,D as t,O as c,J as S,P as I,S as y,N as b,A as D,K as N,F as O}from"./@vue-CTzZmrEY.js";import{d as g,K as k,O as T,t as f,L as V,h as E,M as F,E as R}from"./@ionic-D6JpvR1m.js";import{c as $,u as A,m as U}from"./index-DVNNekmp.js";import{u as C,r as J,a as K,d as G,_ as H}from"./useMailStore-B9U7srDl.js";import{u as j}from"./vue-i18n-DnF4oqIJ.js";import"./@stencil-DBaMOtEh.js";import"./@capacitor-BXp5o1ZG.js";import"./vue-router-D889LiZM.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./pinia-DKQUv1OW.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";import"./@intlify-BAcCFw_v.js";const q={class:"wrapper"},Q={class:"mail-title"},W={class:"mail-sub-title"},X={style:{"font-size":"0.9rem"}},Y={style:{"font-size":"0.7rem",color:"#FD5959"}},Z={class:"mail-content"},tt={key:0,class:"mail-attaches"},at={__name:"MailPopup",setup(P,{expose:_}){const{t:d}=j(),o=$(),m=C(),{getPublicUrl:v}=A(),{popupEnter:p,popupLeave:M}=U(),a=w(!1),s=w({}),x=async e=>{if(o.barLoading=!0,e.isRead==0){const l=await J({mailId:e.id});l.state==="200"?e.isRead=1:await(await f.create({message:l.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present()}s.value=e,o.barLoading=!1,a.value=!0},B=async()=>{o.barLoading=!0;const e=await K({mailId:s.value.id});e.state==="200"?(await m.getMailList(),o.barLoading=!1,a.value=!1,s.value.attachesStatus=1,await(await f.create({message:d("mail.message.receiveSuccess"),duration:1500,position:"top",color:"success",translucent:!0})).present()):(o.barLoading=!1,await(await f.create({message:e.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present())},z=async()=>{o.barLoading=!0;const e=await G({mailId:s.value.id});e.state==="200"?(await m.getMailList(),o.barLoading=!1,a.value=!1,await(await f.create({message:d("mail.message.deleteSuccess"),duration:1500,position:"top",color:"success",translucent:!0})).present()):(await(await f.create({message:e.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),o.barLoading=!1)};return _({showMail:x}),(e,l)=>(i(),r(t(T),{class:"mail-popup",isOpen:a.value,enterAnimation:t(p),leaveAnimation:t(M),onDidDismiss:l[1]||(l[1]=L=>a.value=!1)},{default:u(()=>[n("div",q,[h(t(g),{class:"btn-close",src:t(v)("/mail/icon-popup-close.png"),onClick:l[0]||(l[0]=L=>a.value=!1)},null,8,["src"]),n("h3",Q,c(s.value.title||""),1),n("div",W,[n("div",X,c(e.$t("mail.dearPlayer"))+":",1),n("div",Y,c(s.value.createTime||""),1)]),n("div",Z,c(s.value.content||""),1),s.value.attaches&&s.value.attachesStatus===0?(i(),S("div",tt,[h(t(g),{src:t(v)("/mail/icon-coin.png"),style:{width:"35px",height:"35px"}},null,8,["src"]),n("div",null,c(Math.round(JSON.parse(s.value.attaches).amount*100)/100),1)])):I("",!0),s.value.attaches&&s.value.attachesStatus===0?(i(),r(t(k),{key:1,class:"btn-confirm ion-text-capitalize",fill:"solid",shape:"round",onClick:y(B,["stop"])},{default:u(()=>[b(c(e.$t("mail.button.confirm")),1)]),_:1})):(i(),r(t(k),{key:2,class:"btn-del ion-text-capitalize",fill:"solid",shape:"round",onClick:y(z,["stop"])},{default:u(()=>[b(c(e.$t("mail.button.delete")),1)]),_:1}))])]),_:1},8,["isOpen","enterAnimation","leaveAnimation"]))}},et={slot:"start",class:"mail-icon"},st={class:"mail-title"},ot={style:{"font-size":"1rem"}},it={style:{"font-size":"0.7rem"}},nt={class:"mail-detail"},bt={__name:"Mail",setup(P){const _=$(),d=C(),{getPublicUrl:o}=A(),m=w(null);D(async()=>{_.barLoading=!0,await d.getMailList()});const v=p=>{m.value.showMail(p)};return(p,M)=>(i(),r(t(E),{class:"mail"},{default:u(()=>[t(_).barLoading||!t(d).hasMail?(i(),r(H,{key:0,class:"no-data",desc:p.$t("mail.message.nodata")},null,8,["desc"])):(i(),r(t(V),{key:1},{default:u(()=>[(i(!0),S(O,null,N(t(d).mailList,a=>(i(),r(t(F),{key:a.id,class:"mail-item",lines:"none",onClick:y(s=>v(a),["stop"])},{default:u(()=>[n("div",et,[a.isRead?(i(),r(t(g),{key:0,class:"mail-img",src:t(o)("/mail/icon-mail-open.png")},null,8,["src"])):(i(),r(t(g),{key:1,class:"mail-img",src:t(o)("/mail/icon-mail.png")},null,8,["src"])),a.attaches&&a.attachesStatus===0?(i(),r(t(g),{key:2,class:"mail-tag",src:t(o)("/mail/icon-mail-gift.png")},null,8,["src"])):I("",!0)]),h(t(R),{class:"mail-content"},{default:u(()=>[n("div",st,[n("div",ot,c(a.title||""),1),n("div",it,c(a.createTime||""),1)]),n("div",nt,c(a.content||""),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})),h(at,{ref_key:"mailPopup",ref:m},null,512)]),_:1}))}};export{bt as default};
