import{d as h,j as y,t as x,v as M}from"./@ionic-CQtneEHh.js";import{u as T,k as w}from"./index-DbfdoCpI.js";import{r as c,B as I,b as A,y as B,o as b,H as L,K as k,C as d,J as C,E as m,M as r}from"./@vue-KvDcA5L4.js";import"./@stencil-DBaMOtEh.js";const H={class:"marquee"},E=["innerHTML"],R=["innerHTML"],N={__name:"Marquee",setup(U){const{getImgUrl:p}=T(),u=c(null),s=c(null),l=c(""),f=async()=>{const t=await w();if(t.state==="200"){const e=t.resultData.msgList||[];l.value=e.reduce((n,v)=>{const _=v.msgContent.replaceAll(/<color=#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})>([^<>]+)<\/c>/g,'<span style="color: #$1">$2</span>');return n+='<span style="margin-right: 20px;">'.concat(_,"</span>"),n},"")}else await(await x.create({message:t.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present()};I(()=>{f()});const g=t=>new Promise(e=>setTimeout(e,t));let a;const i=async()=>{if(a&&clearInterval(a),s.value.offsetWidth==0||u.value.offsetWidth==0){await g(500),i();return}const t=25e4,e=M().addElement(s.value).duration(t).fromTo("transform","translateX(0)","translateX(-100%)");e.play(),a=setInterval(()=>{e.stop(),e.play()},t/2)};let o;return A(()=>{o=new ResizeObserver(()=>i()),o.observe(s.value.lastChild)}),B(()=>i()),b(()=>{a&&clearInterval(a),o&&o.disconnect()}),(t,e)=>(L(),k("div",H,[d(m(y),null,{default:C(()=>[d(m(h),{slot:"start",class:"notice-icon",src:m(p)("/home/icon-notice.png"),style:{width:"24px",height:"24px",margin:"0 4px 0 0"}},null,8,["src"]),r("div",{slot:"primary",ref_key:"rollBox",ref:u,class:"roll-box"},[r("div",{ref_key:"rollText",ref:s,class:"roll-text",onAnimationstart:e[0]||(e[0]=(...n)=>t.handleAnimationStar&&t.handleAnimationStar(...n))},[r("div",{innerHTML:l.value},null,8,E),r("div",{innerHTML:l.value},null,8,R)],544)],512)]),_:1})]))}};export{N as _};
