import{r as G,c as X,G as a,J as I,L as T,B as s,D as e,H as c,P as k,S as j,U as Y,O as U,j as Z,A as K,I as o,F as C,K as x,M as E,N as F,V as ee,W as te}from"./@vue-CTzZmrEY.js";import{d as w,t as z,x as V,y as M,z as $,h as A,A as q,B as ae,C as se,D as R,i as oe,o as ie}from"./@ionic-D6JpvR1m.js";import{g as ne,a as re,b as le,c as B,u as W,d as ce,s as me,e as ue,f as ge,h as P,i as de,j as fe}from"./index-BEmC1_-2.js";import{_ as pe}from"./Marquee-mf6wS-Ga.js";import{_ as ye}from"./UserInfo-BvHtGIpl.js";import{b as ve}from"./vue-router-D889LiZM.js";import{d as he}from"./pinia-DKQUv1OW.js";import{_ as Le,u as _e}from"./useMailStore-mMt6MMMi.js";import{S as Ge,A as we,P as Se,a as Ie}from"./swiper-Ba4ICoCD.js";import"./@stencil-DBaMOtEh.js";import"./@capacitor-BXp5o1ZG.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./vue-i18n-DnF4oqIJ.js";import"./@intlify-BAcCFw_v.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";const J=he("game",()=>{const f=G([]),L=async()=>{const i=await ne();i.state==="200"&&(f.value=i.resultData||[])},r=G([]),g=async()=>{const i=await re();i.state==="200"&&(r.value=i.resultData||[])},d=G([]),_=G([]),l=G([]),y=G([]);return{favoriteGameList:f,getFavoriteGames:L,recentGameList:r,getRecentGames:g,recentSearches:d,popularSearches:_,hotGameList:l,recommendGameList:y,getGameSearchData:async()=>{const i=await le();return i.state,code===200&&i&&(d.value=i.resultData.recentSearches||[],_.value=i.resultData.popularSearches||[],r.value=i.resultData.recentGameList||[],l.value=i.resultData.hotGameList||[],y.value=i.resultData.recommendGameList||[]),!0}}},{persistedState:{persist:!1}}),be={key:0,class:"game-name"},Q={__name:"GameItem",props:{game:{type:Object,require:!0}},setup(f){const{getPublicUrl:L}=W(),r=f,g=ve(),d=B(),_=J(),l=async()=>{if(r.game.iconType!=2){d.fullLoading=!0;const i=r.game.gameId||r.game.id,p=await ce({gameId:i});if(p.state==="200"){const D=Capacitor.convertFileSrc(p.resultData);await _.getRecentGames(),g.push({name:"GameWeb",query:{gameId:i,url:encodeURIComponent(D)}})}else await(await z.create({message:p.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present();d.fullLoading=!1}},y=X(()=>_.favoriteGameList.filter(p=>p.gameId==r.game.gameId||p.gameId==r.game.id).length>0),S=async()=>{if(r.game.iconType!=2){d.fullLoading=!0;const i=r.game.gameId||r.game.id,p=await me({gameId:i,opt:y.value?2:1});p.state==="200"?_.getFavoriteGames():await(await z.create({message:p.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),d.fullLoading=!1}};return(i,p)=>(a(),I("div",{class:"game-item",onClick:j(l,["stop"])},[T("div",{class:Y(["game-image",{large:f.game.imageSize==2}])},[s(e(w),{class:"game-icon",src:f.game.imageUrl},null,8,["src"]),f.game.cornerMark==1?(a(),c(e(w),{key:0,class:"game-tag",src:e(L)("/home/icon-new.png")},null,8,["src"])):k("",!0),f.game.cornerMark==2?(a(),c(e(w),{key:1,class:"game-tag",src:e(L)("/home/icon-best.png")},null,8,["src"])):k("",!0),f.game.iconType!=2?(a(),I("div",{key:2,class:"game-collect",onClick:j(S,["stop"])},[y.value?(a(),c(e(w),{key:0,src:e(L)("/home/icon-collection-select.png"),style:{width:"24px",height:"24px"}},null,8,["src"])):(a(),c(e(w),{key:1,src:e(L)("/home/icon-collection-normal.png"),style:{width:"24px",height:"24px"}},null,8,["src"]))])):k("",!0)],2),f.game.imageSize!=2?(a(),I("div",be,U(f.game.name),1)):k("",!0)]))}},ke=["onClick"],De={__name:"GameList",emits:["reduceHeaderHeight"],setup(f,{emit:L}){const r=B(),{preLoadImg:g}=P(),d=G(null),_=G(null),l=Z({}),y=G(1),S=G([]);let i=!1;const p=L;K(async()=>await D());const D=async()=>{const n=await ue();if(n.state==="200"){S.value=n.resultData.labelList||[],y.value=Number(S.value[0].labelId);const h=n.resultData.firstLabelGameList,m=n.resultData.categoryList;S.value[0].gameList=n.resultData.gameAndCategoryList.map(t=>{if(t.iconType==1){const u=h.filter(b=>b.status&&b.gameId==t.id);t.name=u.length>0?u[0].gameName:""}if(t.iconType==2){const u=m.filter(b=>b.categoryId==t.id);t.name=u.length>0?u[0].categoryName:""}return t});for(const[t,u]of S.value[0].gameList.entries())t<=12&&await g(u.imageUrl);r.startLoading=!1;for(const[t,u]of S.value.entries())g(u.imageUrlSelected),g(u.imageUrlUnselected),t>0&&(u.gameList=await H(u.labelId),u.gameList.forEach(b=>g(b.imageUrl)))}else await(await z.create({message:n.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present()},H=async n=>{const h=await ge({labelId:n});if(h.state==="200"){const m=h.resultData.gameList.filter(t=>t.status)||[];return h.resultData.gameAndCategoryList.map(t=>{const u=m.filter(b=>b.status&&b.gameId==t.id);return t.name=u.length>0?u[0].gameName:"",t}).filter(t=>t.imageUrl)}else return await(await z.create({message:h.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),[]},N=n=>{i=!0,y.value=Number(n),l[n].$el.scrollIntoView({behavior:"smooth"})},v=n=>{const h=d.value.$el.offsetHeight,m=_.value.$el.offsetHeight;if(h<m&&n.target.scrollTop>0&&p("reduceHeaderHeight",h-m),n.target.scrollTop==0&&p("reduceHeaderHeight",0),i){const t=l[y.value].$el.offsetTop,u=t+l[y.value].$el.offsetHeight;t<=n.target.scrollTop&&n.target.scrollTop<=u&&(i=!1)}else for(const t in l)l[t].$el.offsetTop<=n.target.scrollTop&&(y.value=Number(t))};return(n,h)=>(a(),c(e(A),{ref_key:"gameList",ref:d,class:"game-list"},{default:o(()=>[s(e(V),null,{default:o(()=>[s(e(M),{class:"ion-justify-content-start"},{default:o(()=>[s(e($),{class:"game-menu",ref_key:"gameMenu",ref:_,size:"2.2"},{default:o(()=>[(a(!0),I(C,null,x(S.value,m=>(a(),I("div",{key:m.labelId,class:"game-label",onClick:t=>N(m.labelId)},[s(E,{name:"fade"},{default:o(()=>[y.value==Number(m.labelId)?(a(),c(e(w),{key:0,src:m.imageUrlSelected,class:"game-img"},null,8,["src"])):(a(),c(e(w),{key:1,src:m.imageUrlUnselected,class:"game-img"},null,8,["src"]))]),_:2},1024)],8,ke))),128))]),_:1},512),s(e($),{size:"9.8",class:"games",onScroll:v},{default:o(()=>[(a(!0),I(C,null,x(S.value,m=>(a(),c(e(M),{ref_for:!0,ref:t=>l[m.labelId]=t,key:m.labelId,class:"ion-justify-content-start"},{default:o(()=>[(a(!0),I(C,null,x(m.gameList,t=>(a(),c(e($),{size:t.imageSize==2?12:t.imageSize==3?8:4},{default:o(()=>[s(Q,{game:t},null,8,["game"])]),_:2},1032,["size"]))),256))]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1},512))}},O={__name:"GameSub",props:{gameKey:{type:String,require:!0}},setup(f){const L=f,r=B(),g=J(),{preLoadImg:d}=P();return K(async()=>{r.fullLoading=!0,L.gameKey=="recentGameList"&&await g.getRecentGames(),L.gameKey=="favoriteGameList"&&await g.getFavoriteGames();for(const[_,l]of g[L.gameKey].entries())_<=16?await d(l.imageUrl):d(l.imageUrl);r.fullLoading=!1}),(_,l)=>(a(),c(e(A),{class:"game-sub"},{default:o(()=>[e(r).fullLoading||e(g)[f.gameKey].length==0?(a(),c(Le,{key:0,class:"no-data"})):(a(),c(e(V),{key:1},{default:o(()=>[s(e(M),{class:"ion-justify-content-start"},{default:o(()=>[(a(!0),I(C,null,x(e(g)[f.gameKey],y=>(a(),c(e($),{size:"3"},{default:o(()=>[s(Q,{game:y},null,8,["game"])]),_:2},1024))),256))]),_:1})]),_:1}))]),_:1}))}},Te={key:0,class:"activity-icon"},Ue={class:"activity-icon"},$e={class:"item-button"},Ce={class:"item-button"},Xe={__name:"Home",setup(f){const L=B(),r=_e(),g=de(),{getPublicUrl:d}=W(),{preLoadImg:_}=P(),l=G("GameList"),y={GameList:De,GameRecent:O,GameFavorite:O},S={GameList:null,GameRecent:"recentGameList",GameFavorite:"favoriteGameList"},i=G(null),p=G([]),D=async()=>{const v=await fe();v.state==="200"?p.value=v.resultData.bannerList||[]:await(await z.create({message:v.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present()};K(async()=>{await D();for(const[v,n]of p.value.entries())v<=1&&await _(n.imageUrl);await r.getMailList()});const H=G(!1),N=v=>{H.value=v<0,v<0&&i.value.$el.scrollIntoView({behavior:"smooth"})};return(v,n)=>(a(),c(e(A),{class:"home"},{default:o(()=>[s(e(oe),null,{default:o(()=>[s(e(V),{style:{padding:"0",position:"sticky",top:"0","z-index":"2"}},{default:o(()=>[s(e(M),{class:"ion-justify-content-between"},{default:o(()=>[s(e($),{size:"4"},{default:o(()=>[s(e(w),{src:e(L).imgLogo.headerLogo,style:{width:"100%",margin:"auto"}},null,8,["src"])]),_:1}),s(e($),{size:"auto",style:{display:"flex"}},{default:o(()=>[e(g).isShowTurnplate?(a(),I("div",Te,[s(e(w),{src:e(d)("/home/icon-home-game.png")},null,8,["src"]),e(g).turnplate.totalRemainTimes>0?(a(),c(e(q),{key:0,class:"activity-icon-tag"},{default:o(()=>[F(U(e(g).turnplate.totalRemainTimes||10),1)]),_:1})):k("",!0)])):k("",!0),T("div",Ue,[s(e(w),{src:e(d)("/home/icon-mail.png"),"router-link":"/account/mail"},null,8,["src"]),e(r).hasUnread?(a(),c(e(q),{key:0,class:"activity-icon-tag"})):k("",!0)])]),_:1})]),_:1})]),_:1}),s(E,{name:"fade"},{default:o(()=>[T("div",null,[H.value?k("",!0):(a(),c(e(Ge),{key:0,modules:[e(we),e(Se),e(ae)],centeredSlides:!0,pagination:{clickable:!0},autoplay:{delay:3e3},loop:!0,lazyPreloadPrevNext:1},{default:o(()=>[(a(!0),I(C,null,x(p.value,(h,m)=>(a(),c(e(Ie),{key:"banner_".concat(m)},{default:o(()=>[s(e(w),{src:h.imageUrl,loading:"lazy"},null,8,["src"])]),_:2},1024))),128))]),_:1},8,["modules"])),s(pe),s(ye,{class:"user-info",ref_key:"userInfo",ref:i},{default:o(()=>[T("div",$e,[s(e(w),{src:e(d)("/home/icon-deposit.png"),style:{height:"8vw",margin:"auto"}},null,8,["src"]),T("div",null,U(v.$t("home.deposit")),1)]),T("div",Ce,[s(e(w),{src:e(d)("/home/icon-withdraw.png"),style:{height:"8vw",margin:"auto"}},null,8,["src"]),T("div",null,U(v.$t("home.withdraw")),1)])]),_:1},512),s(e(se),{modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=h=>l.value=h),mode:"md"},{default:o(()=>[s(e(R),{class:"ion-text-capitalize",value:"GameList"},{default:o(()=>[F(U(v.$t("home.allgames")),1)]),_:1}),s(e(R),{class:"ion-text-capitalize",value:"GameRecent"},{default:o(()=>[F(U(v.$t("home.recent")),1)]),_:1}),s(e(R),{class:"ion-text-capitalize",value:"GameFavorite"},{default:o(()=>[F(U(v.$t("home.favorite")),1)]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1}),s(e(ie),null,{default:o(()=>[(a(),c(ee,{exclude:"GameSub"},[(a(),c(te(y[l.value]),{class:"bottom-view",gameKey:S[l.value],onReduceHeaderHeight:N},null,40,["gameKey"]))],1024))]),_:1})]),_:1}))}};export{Xe as default};
