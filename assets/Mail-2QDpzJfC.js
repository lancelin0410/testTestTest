import{r as w,G as o,H as c,I as d,L as i,B as h,D as t,O as u,J as S,P as I,S as y,N as k,A as z,K as D,F as N}from"./@vue-CTzZmrEY.js";import{d as g,K as L,O,t as f,L as T,h as V,M as A,E as F}from"./@ionic-Dolm7zi0.js";import{c as $,u as C}from"./index-B22vJmmO.js";import{u as P,r as R,a as U,d as E,_ as J}from"./useMailStore-DG5wTqqd.js";import{u as K}from"./vue-i18n-DnF4oqIJ.js";import"./@stencil-DBaMOtEh.js";import"./@capacitor-BXp5o1ZG.js";import"./vue-router-D889LiZM.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./pinia-DKQUv1OW.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";import"./@intlify-BAcCFw_v.js";const G={class:"wrapper"},H={class:"mail-title"},j={class:"mail-sub-title"},q={style:{"font-size":"0.9rem"}},Q={style:{"font-size":"0.7rem",color:"#FD5959"}},W={class:"mail-content"},X={key:0,class:"mail-attaches"},Y={__name:"MailPopup",setup(x,{expose:_}){const{t:m}=K(),s=$(),p=P(),{getPublicUrl:v}=C(),n=w(!1),e=w({}),r=async a=>{if(s.barLoading=!0,a.isRead==0){const l=await R({mailId:a.id});l.state==="200"?a.isRead=1:await(await f.create({message:l.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present()}e.value=a,s.barLoading=!1,n.value=!0},M=async()=>{s.barLoading=!0;const a=await U({mailId:e.value.id});a.state==="200"?(await p.getMailList(),s.barLoading=!1,n.value=!1,e.value.attachesStatus=1,await(await f.create({message:m("mail.message.receiveSuccess"),duration:1500,position:"top",color:"success",translucent:!0})).present()):(s.barLoading=!1,await(await f.create({message:a.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present())},B=async()=>{s.barLoading=!0;const a=await E({mailId:e.value.id});a.state==="200"?(await p.getMailList(),s.barLoading=!1,n.value=!1,await(await f.create({message:m("mail.message.deleteSuccess"),duration:1500,position:"top",color:"success",translucent:!0})).present()):(await(await f.create({message:a.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),s.barLoading=!1)};return _({showMail:r}),(a,l)=>(o(),c(t(O),{class:"mail-popup",isOpen:n.value,onDidDismiss:l[1]||(l[1]=b=>n.value=!1)},{default:d(()=>[i("div",G,[h(t(g),{class:"btn-close",src:t(v)("/mail/icon-popup-close.png"),onClick:l[0]||(l[0]=b=>n.value=!1)},null,8,["src"]),i("h3",H,u(e.value.title||""),1),i("div",j,[i("div",q,u(a.$t("mail.dearPlayer"))+":",1),i("div",Q,u(e.value.createTime||""),1)]),i("div",W,u(e.value.content||""),1),e.value.attaches&&e.value.attachesStatus===0?(o(),S("div",X,[h(t(g),{src:t(v)("/mail/icon-coin.png"),style:{width:"35px",height:"35px"}},null,8,["src"]),i("div",null,u(Math.round(JSON.parse(e.value.attaches).amount*100)/100),1)])):I("",!0),e.value.attaches&&e.value.attachesStatus===0?(o(),c(t(L),{key:1,class:"btn-confirm ion-text-capitalize",fill:"solid",shape:"round",onClick:y(M,["stop"])},{default:d(()=>[k(u(a.$t("mail.button.confirm")),1)]),_:1})):(o(),c(t(L),{key:2,class:"btn-del ion-text-capitalize",fill:"solid",shape:"round",onClick:y(B,["stop"])},{default:d(()=>[k(u(a.$t("mail.button.delete")),1)]),_:1}))])]),_:1},8,["isOpen"]))}},Z={slot:"start",class:"mail-icon"},tt={class:"mail-title"},at={style:{"font-size":"1rem"}},et={style:{"font-size":"0.7rem"}},st={class:"mail-detail"},yt={__name:"Mail",setup(x){const _=$(),m=P(),{getPublicUrl:s}=C(),p=w(null);z(async()=>{_.barLoading=!0,await m.getMailList(),_.barLoading=!1});const v=n=>{p.value.showMail(n)};return(n,e)=>(o(),c(t(V),{class:"mail"},{default:d(()=>[t(m).hasMail?(o(),c(t(T),{key:0},{default:d(()=>[(o(!0),S(N,null,D(t(m).mailList,r=>(o(),c(t(A),{key:r.id,class:"mail-item",lines:"none",onClick:y(M=>v(r),["stop"])},{default:d(()=>[i("div",Z,[r.isRead?(o(),c(t(g),{key:0,class:"mail-img",src:t(s)("/mail/icon-mail-open.png")},null,8,["src"])):(o(),c(t(g),{key:1,class:"mail-img",src:t(s)("/mail/icon-mail.png")},null,8,["src"])),r.attaches&&r.attachesStatus===0?(o(),c(t(g),{key:2,class:"mail-tag",src:t(s)("/mail/icon-mail-gift.png")},null,8,["src"])):I("",!0)]),h(t(F),{class:"mail-content"},{default:d(()=>[i("div",tt,[i("div",at,u(r.title||""),1),i("div",et,u(r.createTime||""),1)]),i("div",st,u(r.content||""),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):(o(),c(J,{key:1,class:"no-data",desc:n.$t("mail.message.nodata")},null,8,["desc"])),h(Y,{ref_key:"mailPopup",ref:p},null,512)]),_:1}))}};export{yt as default};
